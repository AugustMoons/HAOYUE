# 皓月互联集成管理系统

```
# 一、引言

随着皓月互联项目的日益扩大，不同的功能模块越来越多，管理项目往往需要多个平台切换，最根本问题是切换操作设备并且无云同步的情况下，管理平台地址与账密等各种信息都需要记忆或者查找，颇为麻烦。为解决此问题，因此创立 <皓月互联集成管理系统> 项目，以解决此问题，方便皓月项目管理为根本目的

#二、项目基本信息

>项目经理：八月
>需求优先级：高
>项目所需开发语言：Python,html5,css,JavaScrip等

#项目进度与变更日志

|**日期**|**项目进度**|**版本号**|**变更人**|**变更内容**|
|:----|:----|:----|:----|
|24/1/13|1%|Null|八月|创建项目文档|
|24/1/14|10%|Null|八月|完成login前后端以及安全逻辑|
|    |    |    |    |

#需求目标

1.整合皓月互联所有项目管理平台与功能
2.web端实现云端一体化管理
3.团队重要信息与团队文档的协同编辑

#三、功能详细说明

##实现逻辑

###前端：
        通过web端访问，自动进入/login页面，要求用户必须先登录，登录失败提示信息，登录成功后跳转至/页面，超级管理员登录入口为/superlogin(访问此页面不会跳转至/)。在/页面中设计UI，要求菜单栏显示用户名并可对账户信息进行修改以及退出登录，菜单栏按服务器VNC，魔方财务(直接跳转)，轻舟云(直接跳转)，文档等条目分类(若登录为管理员账户，则多一条用户管理栏目)，、
    1. /login页面要求：
            为普通用户和管理员登录入口，有邮箱和账密登录两种方式
    2. /superlogin页面要求：
            为超级管理员登录入口，要求多重验证后才能登录，账密邮箱验证码均需填入，并且还需填入SID1和SID2以及KEY参数，所有都对上才能正确访问，每次登录之后SID1，SID2，KEY数值会变更，最新参数会发送至超级管理员邮箱
    3. /页面要求：
            显示皓月互联的所有网站及地址(内容根据用户权限区分)
    4. /vnc页面要求：
            网格化设计，可增删vnc条目，在网页内实现远程控制
    5. /word页面要求：
            条目设计，可上传或下载文档，以及站内协同编辑
    6. /user页面要求：
            根据当前登录的用户，显示该用户在后端存储的基本信息，包括：ID，权限组，电话号码，邮箱地址，用户名，账户状态
    7. /admin页面要求：
            如果为管理员账户，则允许访问，否则一律跳转至/页面。在该页面除了与普通用户一样可以查看修改自身的基本信息，还可以存储并查看自身各站点的账密信息，以及对其他用户进行修改，对同为管理员账户的账号无法修改。管理员账户信息统一只能由超级管理员以及自身修改，权限修改只能上对下修改
    6.保留


###后端：(用户名不能重复！！！！！！！！！！！！)
    1.sql：存储两个表：
        用户表，包括以下内容：
            [id INT]               $ID
            [permissions INT]      $所属权限组ID
            [username TEXT]        $用户名
            [phonenumber TEXT]    $手机号
            [email TEXT]          $邮箱地址
            [password TEXT]        $密码
            [static TEXT]          $用户状态

        用户组表，包括以下内容：
            [id INT]               $用户组ID
            [groupname TEXT]       $用户组名称

            $用户组初始设有普通用户，管理员，超级管理员三级
            $普通用户：只允许访问/，/user，/vnc三个页面(其中内容均按用户各自区分)
            $管理员：允许访问所有页面，查看修改除超级管理员以及自身权限和他人密码之外所有信息
            $超级管理员：允许访问所有页面，查看并修改除他人密码之外所有信息

    2.loginctrl：functions/loginctrl.py
    登录控制：
        两种登录方式：
            账密登录：
                输入正确账密之后，在后端验证是否正确，登录失败提示信息，登录成功后跳转至/页面
            邮箱登录：
                输入邮箱，点击获取验证码之后后端生成验证码并写入数据库，一分钟后清空该条验证码，再调用SMTP，实现邮箱验证码的发送，用户再输入验证码，后端比对是否正确，登录失败提示信息，登录成功后跳转至/页面

    3.SMTP服务：functions/smtp.py   
        实现发送邮箱验证码功能，验证码发送至邮箱，同时存入数据库的e-mailcode项，并且有效时长为一分钟

    4.TOML:
        1. lib/toml/su/superadmin.toml:存储超级管理员账户信息
            username TEXT        \\用户名
            SID1 INT             \\SID2，为整型
            SID2 INT             \\SID1，为整型
            KEY TEXT             \\KEY参数，为字符串
            password TEXT        \\密码
            email TEXT          \\邮箱
            emailcode TEXT      \\邮箱验证码
            phonenumber          \\手机号
        2. lib/toml/config.toml:

    5.log：
        1. functions/log/log.py：日志系统
        2. lib/log/main.log: 记录所有操作
        3. lib/log/smtp.log: 记录验证码使用记录
        4. lib/log/sql.log: 记录数据库数据读写修改
        5. lib/log/login.log: 记录用户登录记录    

    6.


```